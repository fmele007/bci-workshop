name: Secrets in Action – Demo

on:
  workflow_dispatch

jobs:

  # Example 1: Masked Secret Demo
  ###############################
  masked-secret:
    name: Example 1 – Masked Secret
    runs-on: ubuntu-latest
    steps:
      - name: Verify secret is injected
        run: |
          if [ -z "$DEMO_SECRET" ]; then
            echo "Secret NOT available"
            exit 1
          else
            echo "Secret is available"
          fi
        env:
          DEMO_SECRET: ${{ secrets.DEMO_SECRET }}

      - name: Attempt to print secret (will be masked)
        run: |
          echo "Secret value: $DEMO_SECRET"
        env:
          DEMO_SECRET: ${{ secrets.DEMO_SECRET }}



  # Example 2: Hashed Secret Demo
  ###############################
  hashed-secret:
    name: Example 2 – Hash the Secret
    runs-on: ubuntu-latest
    steps:
      - name: Hash secret value
        run: |
          echo "SHA256 hash of secret:"
          echo -n "$DEMO_SECRET" | sha256sum
        env:
          DEMO_SECRET: ${{ secrets.DEMO_SECRET }}



  # Example 3: Environment & Approval
  # -----------------------------------
  environment-secret:
    name: Example 3 – Environment Secret
    runs-on: ubuntu-latest
    environment: production
    steps:
      - name: Access environment-scoped secret
        run: |
          echo "Production secret is available"
          echo "Secret length: ${PROD_SECRET}"
        env:
          PROD_SECRET: ${{ secrets.PROD_SECRET }}
